import base64
exec(base64.b64decode('aW1wb3J0IHJhbmRvbQoKIyBIw6BtIHnDqnUgY+G6p3UgbmfGsOG7nWkgZMO5bmcgbmjhuq1wIGzhu4tjaCBz4butIGvhur90IHF14bqjCmRlZiBnZXRfaGlzdG9yeV9mcm9tX2pzKCk6CiAgICBoaXN0b3J5ID0gW10KICAgIHByaW50KCJOaOG6rXAgNyBr4bq/dCBxdeG6oyBn4bqnbiBuaOG6pXQgY+G7p2EgdMOgaS944buJdSAoMCA9IFjhu4l1LCAxID0gVMOgaSk6IikKICAgIGZvciBpIGluIHJhbmdlKDEsIDgpOgogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIGRhdGEgPSBpbnB1dChmIk5o4bqtcCBr4bq/dCBxdeG6oyB7aX0vNyAoMCBob+G6t2MgMSk6ICIpCiAgICAgICAgICAgIGlmIGRhdGEgaW4gWycwJywgJzEnXToKICAgICAgICAgICAgICAgIGhpc3RvcnkuYXBwZW5kKGludChkYXRhKSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCgiROG7ryBsaeG7h3Uga2jDtG5nIGjhu6NwIGzhu4cuIFZ1aSBsw7JuZyBuaOG6rXAgMCBob+G6t2MgMS4iKQogICAgcmV0dXJuIGhpc3RvcnkKCiMgSMOgbSBwaMOhdCBoaeG7h24gbeG6q3UgdHJvbmcgZOG7ryBsaeG7h3UgbOG7i2NoIHPhu60KZGVmIGRldGVjdF9wYXR0ZXJuKGhpc3RvcnkpOgogICAgaWYgbGVuKGhpc3RvcnkpIDwgNzoKICAgICAgICByZXR1cm4gTm9uZQogICAgCiAgICBsYXN0XzcgPSAnJy5qb2luKG1hcChzdHIsIGhpc3RvcnlbLTc6XSkpCiAgICBjb21tb25fcGF0dGVybnMgPSB7CiAgICAgICAgIjExMTExMTEiOiAiWOG7iXUiLCAiMDAwMDAwMCI6ICJUw6BpIiwgCiAgICAgICAgIjEwMTAxMDEiOiAiVMOgaSIsICIwMTAxMDEwIjogIljhu4l1IiwgCiAgICAgICAgIjExMDAxMTAiOiAiWOG7iXUiLCAiMDAxMTAwMSI6ICJUw6BpIiwgCiAgICAgICAgIjExMTAwMDEiOiAiWOG7iXUiLCAiMDAwMTExMCI6ICJUw6BpIiwKICAgICAgICAiMTAwMTAwMSI6ICJY4buJdSIsICIwMTEwMTEwIjogIlTDoGkiLCAKICAgICAgICAiMTEwMTAxMSI6ICJY4buJdSIsICIwMDEwMTAwIjogIlTDoGkiLCAKICAgICAgICAiMTExMDAxMSI6ICJY4buJdSIsICIwMDAxMTAwIjogIlTDoGkiLCAKICAgICAgICAiMTAxMTEwMSI6ICJY4buJdSIsICIwMTAwMDEwIjogIlTDoGkiLAogICAgICAgICIxMDAxMDEwIjogIljhu4l1IiwgIjAxMTAxMDEiOiAiVMOgaSIsCiAgICAgICAgIjExMDExMDAiOiAiWOG7iXUiLCAiMDAxMDAxMSI6ICJUw6BpIiwKICAgICAgICAiMTAxMDExMSI6ICJY4buJdSIsICIwMTAxMDAwIjogIlTDoGkiLAogICAgICAgICIxMTEwMTAwIjogIljhu4l1IiwgIjAwMDEwMTEiOiAiVMOgaSIsCiAgICAgICAgIjEwMDExMDEiOiAiWOG7iXUiLCAiMDExMDAxMCI6ICJUw6BpIiwKICAgICAgICAiMTEwMTAwMSI6ICJY4buJdSIsICIwMDEwMTEwIjogIlTDoGkiLAogICAgICAgICIxMDEwMDEwIjogIljhu4l1IiwgIjAxMDExMDEiOiAiVMOgaSIsCiAgICAgICAgIjExMTEwMDAiOiAiWOG7iXUiLCAiMDAwMDExMSI6ICJUw6BpIiwKICAgICAgICAiMTEwMDEwMSI6ICJY4buJdSIsICIwMDExMDEwIjogIlTDoGkiLAogICAgICAgICIxMDExMDExIjogIljhu4l1IiwgIjAxMDAxMDAiOiAiVMOgaSIsCiAgICAgICAgIjEwMDExMTAiOiAiWOG7iXUiLCAiMDExMDAwMSI6ICJUw6BpIiwKICAgICAgICAiMTEwMDAxMSI6ICJY4buJdSIsICIwMDExMTAwIjogIlTDoGkiLAogICAgICAgICIxMDEwMDAxIjogIljhu4l1IiwgIjAxMDExMTAiOiAiVMOgaSIsCiAgICAgICAgIjExMTAxMTAiOiAiWOG7iXUiLCAiMDAwMTAwMSI6ICJUw6BpIiwKICAgICAgICAiMTAwMDExMSI6ICJY4buJdSIsICIwMTExMDAwIjogIlTDoGkiLAogICAgICAgICIxMTAxMTEwIjogIljhu4l1IiwgIjAwMTAwMDEiOiAiVMOgaSIsCiAgICAgICAgIjEwMTExMTEiOiAiWOG7iXUiLCAiMDEwMDAwMCI6ICJUw6BpIiwKICAgICAgICAiMTAwMDAwMSI6ICJY4buJdSIsICIwMTExMTEwIjogIlTDoGkiLAogICAgICAgICIxMDAxMTAwIjogIljhu4l1IiwgIjAxMTAwMTEiOiAiVMOgaSIsCiAgICAgICAgIjEwMTEwMDEiOiAiWOG7iXUiLCAiMDEwMDExMCI6ICJUw6BpIiwKICAgICAgICAiMTEwMDAwMSI6ICJY4buJdSIsICIwMDExMTEwIjogIlTDoGkiLAogICAgICAgICIxMDEwMTAwIjogIljhu4l1IiwgIjAxMDEwMTEiOiAiVMOgaSIsCiAgICAgICAgIjEwMDAxMTAiOiAiWOG7iXUiLCAiMDExMTAwMSI6ICJUw6BpIiwKICAgICAgICAiMTExMDAwMCI6ICJY4buJdSIsICIwMDAxMTExIjogIlTDoGkiLAogICAgICAgICIxMTAxMTAxIjogIljhu4l1IiwgIjAwMTAwMTAiOiAiVMOgaSIsCiAgICAgICAgIjExMTEwMTEiOiAiWOG7iXUiLCAiMDAwMDEwMCI6ICJUw6BpIiwKICAgICAgICAiMTAwMTAwMCI6ICJY4buJdSIsICIwMTEwMTExIjogIlTDoGkiLAogICAgICAgICIxMTExMDEwIjogIljhu4l1IiwgIjAwMDAxMDEiOiAiVMOgaSIKICAgIH0KICAgIHJldHVybiBjb21tb25fcGF0dGVybnMuZ2V0KGxhc3RfNywgTm9uZSkKCiMgSMOgbSBk4buxIMSRb8OhbiB0w6BpIHjhu4l1CmRlZiBwcmVkaWN0X3RhaV94aXUoaGlzdG9yeSk6CiAgICBpZiBub3QgaGlzdG9yeToKICAgICAgICByZXR1cm4gcmFuZG9tLmNob2ljZShbIlTDoGkiLCAiWOG7iXUiXSkKICAgIAogICAgIyBLaeG7g20gdHJhIG3huqt1IHh14bqldCBoaeG7h24KICAgIHBhdHRlcm5fcHJlZGljdGlvbiA9IGRldGVjdF9wYXR0ZXJuKGhpc3RvcnkpCiAgICBpZiBwYXR0ZXJuX3ByZWRpY3Rpb246CiAgICAgICAgcmV0dXJuIHBhdHRlcm5fcHJlZGljdGlvbgogICAgCiAgICAjIFTDrW5oIHRvw6FuIHjDoWMgc3XhuqV0CiAgICBsYXN0X3Jlc3VsdHMgPSBoaXN0b3J5Wy03Ol0KICAgIHByb2JhYmlsaXR5ID0gc3VtKGxhc3RfcmVzdWx0cykgLyBsZW4obGFzdF9yZXN1bHRzKQogICAgCiAgICAjIEtp4buDbSB0cmEgY2h14buXaSBsacOqbiB04bulYwogICAgaWYgaGlzdG9yeVstNTpdLmNvdW50KDEpID09IDU6CiAgICAgICAgcmV0dXJuICJY4buJdSIKICAgIGVsaWYgaGlzdG9yeVstNTpdLmNvdW50KDApID09IDU6CiAgICAgICAgcmV0dXJuICJUw6BpIgogICAgCiAgICByZXR1cm4gIlTDoGkiIGlmIHByb2JhYmlsaXR5ID4gMC41NSBlbHNlICJY4buJdSIKCiMgQ2jhuqF5IGNoxrDGoW5nIHRyw6xuaAppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaGlzdG9yeSA9IGdldF9oaXN0b3J5X2Zyb21fanMoKQogICAgcHJlZGljdGlvbiA9IHByZWRpY3RfdGFpX3hpdShoaXN0b3J5KQogICAgcHJpbnQoZiJE4buxIMSRb8OhbiBr4bq/dCBxdeG6oyB0aeG6v3AgdGhlbzoge3ByZWRpY3Rpb259IikKICAgIHByaW50KGYiTOG7i2NoIHPhu60gZ+G6p24gxJHDonk6IHtoaXN0b3J5fSIpCiAgICBwcmludCgiVG9vbCBieSBAdnNrMTExIikK').decode())