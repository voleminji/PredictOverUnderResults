import base64
exec(base64.b64decode('aW1wb3J0IHJhbmRvbQ0KDQojIEjDoG0gecOqdSBj4bqndSBuZ8aw4budaSBkw7luZyBuaOG6rXAgbOG7i2NoIHPhu60ga+G6v3QgcXXhuqMNCmRlZiBnZXRfaGlzdG9yeV9mcm9tX2pzKCk6DQogICAgaGlzdG9yeSA9IFtdDQogICAgcHJpbnQoIk5o4bqtcCA3IGvhur90IHF14bqjIGfhuqduIG5o4bqldCBj4bunYSB0w6BpL3jhu4l1ICgwID0gWOG7iXUsIDEgPSBUw6BpKToiKQ0KICAgIGZvciBpIGluIHJhbmdlKDEsIDgpOg0KICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgZGF0YSA9IGlucHV0KGYiTmjhuq1wIGvhur90IHF14bqjIHtpfS83ICgwIGhv4bq3YyAxKTogIikNCiAgICAgICAgICAgIGlmIGRhdGEgaW4gWycwJywgJzEnXToNCiAgICAgICAgICAgICAgICBoaXN0b3J5LmFwcGVuZChpbnQoZGF0YSkpDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgcHJpbnQoIkThu68gbGnhu4d1IGtow7RuZyBo4bujcCBs4buHLiBWdWkgbMOybmcgbmjhuq1wIDAgaG/hurdjIDEuIikNCiAgICByZXR1cm4gaGlzdG9yeQ0KDQojIEjDoG0gcGjDoXQgaGnhu4duIG3huqt1IHRyb25nIGThu68gbGnhu4d1IGzhu4tjaCBz4butDQpkZWYgZGV0ZWN0X3BhdHRlcm4oaGlzdG9yeSk6DQogICAgaWYgbGVuKGhpc3RvcnkpIDwgNzoNCiAgICAgICAgcmV0dXJuIE5vbmUNCiAgICANCiAgICBsYXN0XzcgPSAnJy5qb2luKG1hcChzdHIsIGhpc3RvcnlbLTc6XSkpDQogICAgY29tbW9uX3BhdHRlcm5zID0gew0KICAgICAgICAiMTExMTExMSI6ICJY4buJdSIsICIwMDAwMDAwIjogIlTDoGkiLCANCiAgICAgICAgIjEwMTAxMDEiOiAiVMOgaSIsICIwMTAxMDEwIjogIljhu4l1IiwgDQogICAgICAgICIxMTAwMTEwIjogIljhu4l1IiwgIjAwMTEwMDEiOiAiVMOgaSIsIA0KICAgICAgICAiMTExMDAwMSI6ICJY4buJdSIsICIwMDAxMTEwIjogIlTDoGkiLA0KICAgICAgICAiMTAwMTAwMSI6ICJY4buJdSIsICIwMTEwMTEwIjogIlTDoGkiLCANCiAgICAgICAgIjExMDEwMTEiOiAiWOG7iXUiLCAiMDAxMDEwMCI6ICJUw6BpIiwgDQogICAgICAgICIxMTEwMDExIjogIljhu4l1IiwgIjAwMDExMDAiOiAiVMOgaSIsIA0KICAgICAgICAiMTAxMTEwMSI6ICJY4buJdSIsICIwMTAwMDEwIjogIlTDoGkiLA0KICAgICAgICAiMTAwMTAxMCI6ICJY4buJdSIsICIwMTEwMTAxIjogIlTDoGkiLA0KICAgICAgICAiMTEwMTEwMCI6ICJY4buJdSIsICIwMDEwMDExIjogIlTDoGkiLA0KICAgICAgICAiMTAxMDExMSI6ICJY4buJdSIsICIwMTAxMDAwIjogIlTDoGkiLA0KICAgICAgICAiMTExMDEwMCI6ICJY4buJdSIsICIwMDAxMDExIjogIlTDoGkiLA0KICAgICAgICAiMTAwMTEwMSI6ICJY4buJdSIsICIwMTEwMDEwIjogIlTDoGkiLA0KICAgICAgICAiMTEwMTAwMSI6ICJY4buJdSIsICIwMDEwMTEwIjogIlTDoGkiLA0KICAgICAgICAiMTAxMDAxMCI6ICJY4buJdSIsICIwMTAxMTAxIjogIlTDoGkiDQogICAgfQ0KICAgIHJldHVybiBjb21tb25fcGF0dGVybnMuZ2V0KGxhc3RfNywgTm9uZSkNCg0KIyBIw6BtIGThu7EgxJFvw6FuIHTDoGkgeOG7iXUNCmRlZiBwcmVkaWN0X3RhaV94aXUoaGlzdG9yeSk6DQogICAgaWYgbm90IGhpc3Rvcnk6DQogICAgICAgIHJldHVybiByYW5kb20uY2hvaWNlKFsiVMOgaSIsICJY4buJdSJdKQ0KICAgIA0KICAgICMgS2nhu4NtIHRyYSBt4bqrdSB4deG6pXQgaGnhu4duDQogICAgcGF0dGVybl9wcmVkaWN0aW9uID0gZGV0ZWN0X3BhdHRlcm4oaGlzdG9yeSkNCiAgICBpZiBwYXR0ZXJuX3ByZWRpY3Rpb246DQogICAgICAgIHJldHVybiBwYXR0ZXJuX3ByZWRpY3Rpb24NCiAgICANCiAgICAjIFTDrW5oIHRvw6FuIHjDoWMgc3XhuqV0DQogICAgbGFzdF9yZXN1bHRzID0gaGlzdG9yeVstNzpdDQogICAgcHJvYmFiaWxpdHkgPSBzdW0obGFzdF9yZXN1bHRzKSAvIGxlbihsYXN0X3Jlc3VsdHMpDQogICAgDQogICAgIyBLaeG7g20gdHJhIGNodeG7l2kgbGnDqm4gdOG7pWMNCiAgICBpZiBoaXN0b3J5Wy01Ol0uY291bnQoMSkgPT0gNToNCiAgICAgICAgcmV0dXJuICJY4buJdSINCiAgICBlbGlmIGhpc3RvcnlbLTU6XS5jb3VudCgwKSA9PSA1Og0KICAgICAgICByZXR1cm4gIlTDoGkiDQogICAgDQogICAgcmV0dXJuICJUw6BpIiBpZiBwcm9iYWJpbGl0eSA+IDAuNTUgZWxzZSAiWOG7iXUiDQoNCiMgQ2jhuqF5IGNoxrDGoW5nIHRyw6xuaA0KaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoNCiAgICBoaXN0b3J5ID0gZ2V0X2hpc3RvcnlfZnJvbV9qcygpDQogICAgcHJlZGljdGlvbiA9IHByZWRpY3RfdGFpX3hpdShoaXN0b3J5KQ0KICAgIHByaW50KGYiROG7sSDEkW/DoW4ga+G6v3QgcXXhuqMgdGnhur9wIHRoZW86IHtwcmVkaWN0aW9ufSIpDQogICAgcHJpbnQoZiJM4buLY2ggc+G7rSBn4bqnbiDEkcOieToge2hpc3Rvcnl9IikNCiAgICBwcmludCgiVG9vbCBieSBAdnNrMTExIikNCg==').decode())